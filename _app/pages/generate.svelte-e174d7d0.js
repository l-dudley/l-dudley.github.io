import{S as Y,i as Z,s as ee,e as T,t as B,c as S,a as k,h as j,d as h,b as D,f as G,g as M,H as E,j as te,k as A,N as le,m as $,I as se,O as ae,n as J,w as ie,P as re}from"../chunks/index-b1f754cc.js";import{g as oe,a as ne}from"../chunks/db-c0070083.js";function Q(b,l,t){const c=b.slice();return c[8]=l[t],c}function X(b,l){var H,I;let t,c=((H=l[1][l[8].id])==null?void 0:H.firstName)+" "+((I=l[1][l[8].id])==null?void 0:I.lastName),y,u=`${l[8].left}px`,p=`${l[8].top}px`;return{key:b,first:null,c(){t=T("div"),y=B(c),this.h()},l(d){t=S(d,"DIV",{class:!0});var r=k(t);y=j(r,c),r.forEach(h),this.h()},h(){var d;D(t,"class","seat-box svelte-1pccs5y"),G(t,"left",u,!1),G(t,"top",p,!1),G(t,"background-color",(d=l[1][l[8].id])!=null&&d.valid?"white":"red",!1),this.first=t},m(d,r){M(d,t,r),E(t,y)},p(d,r){var s,o,i;l=d,r&3&&c!==(c=((s=l[1][l[8].id])==null?void 0:s.firstName)+" "+((o=l[1][l[8].id])==null?void 0:o.lastName))&&te(y,c),r&1&&u!==(u=`${l[8].left}px`)&&G(t,"left",u,!1),r&1&&p!==(p=`${l[8].top}px`)&&G(t,"top",p,!1),r&3&&G(t,"background-color",(i=l[1][l[8].id])!=null&&i.valid?"white":"red",!1)},d(d){d&&h(t)}}}function ce(b){let l,t,c,y,u,p,H,I,d,r,s,o,i,f,v,R,_,g,a=[],w=new Map,m,V,N=b[0];const q=e=>e[8].id;for(let e=0;e<N.length;e+=1){let n=Q(b,N,e),L=q(n);w.set(L,a[e]=X(L,n))}return{c(){l=A(),t=T("h2"),c=B("Generate Seating Chart"),y=A(),u=T("div"),p=T("div"),H=T("button"),I=B("Generate Chart"),d=A(),r=T("div"),s=T("h4"),o=B("Front"),i=A(),f=T("div"),v=T("h4"),R=B("Left"),_=A(),g=T("div");for(let e=0;e<a.length;e+=1)a[e].c();this.h()},l(e){le('[data-svelte="svelte-13jkzv9"]',document.head).forEach(h),l=$(e),t=S(e,"H2",{class:!0});var L=k(t);c=j(L,"Generate Seating Chart"),L.forEach(h),y=$(e),u=S(e,"DIV",{class:!0});var C=k(u);p=S(C,"DIV",{class:!0});var F=k(p);H=S(F,"BUTTON",{class:!0});var K=k(H);I=j(K,"Generate Chart"),K.forEach(h),F.forEach(h),C.forEach(h),d=$(e),r=S(e,"DIV",{class:!0});var O=k(r);s=S(O,"H4",{class:!0});var z=k(s);o=j(z,"Front"),z.forEach(h),i=$(O),f=S(O,"DIV",{class:!0});var P=k(f);v=S(P,"H4",{class:!0});var U=k(v);R=j(U,"Left"),U.forEach(h),_=$(P),g=S(P,"DIV",{class:!0});var x=k(g);for(let W=0;W<a.length;W+=1)a[W].l(x);x.forEach(h),P.forEach(h),O.forEach(h),this.h()},h(){document.title="Generate Seating Chart",D(t,"class","title is-2"),D(H,"class","button is-primary"),D(p,"class","control"),D(u,"class","field is-grouped"),D(s,"class","title is-4 has-text-centered mb-0 front-heading svelte-1pccs5y"),D(v,"class","title is-4 has-text-centered left-heading svelte-1pccs5y"),D(g,"class","room-container svelte-1pccs5y"),D(f,"class","is-flex"),D(r,"class","box")},m(e,n){M(e,l,n),M(e,t,n),E(t,c),M(e,y,n),M(e,u,n),E(u,p),E(p,H),E(H,I),M(e,d,n),M(e,r,n),E(r,s),E(s,o),E(r,i),E(r,f),E(f,v),E(v,R),E(f,_),E(f,g);for(let L=0;L<a.length;L+=1)a[L].m(g,null);m||(V=se(H,"click",b[2]),m=!0)},p(e,[n]){n&3&&(N=e[0],a=ae(a,n,q,1,e,N,w,g,re,X,null,Q))},i:J,o:J,d(e){e&&h(l),e&&h(t),e&&h(y),e&&h(u),e&&h(d),e&&h(r);for(let n=0;n<a.length;n+=1)a[n].d();m=!1,V()}}}function fe(b,l,t){let c=[],y=[],u={},p={};const H={front:0,right:1,back:2,left:3},I=({top:s,left:o})=>{let _=[];return s<200&&_.push("front"),s>600&&_.push("back"),o<700&&_.push("left"),o>700&&_.push("right"),_},d=(s,o,i)=>{const v=s.rules.filter(m=>m.type==="facing").map(m=>H[m.criteria]),R=s.rules.filter(m=>m.type==="location").map(m=>m.criteria);let _=Math.floor(Math.random()*i.length),g=!0,a=null,w=1;for(;g&&w<1e3;){const m=i[_];let V=[];m.group.forEach(C=>{const F=o[C],K=(F==null?void 0:F.rules.filter(O=>O.type==="nogroup"))||[];V.push(K.map(O=>O.criteria))}),a=i[_].id;const N=o[a],q=typeof N!="undefined"&&N!==null&&N!=="",e=V.flat().filter(C=>s.id===C).length>0,n=v.length>0?v[0]!=m.direction:!1,L=R.length>0?!p[a].includes(R[0]):!1;console.log(L),g=q||e||n||L,w+=1,_=Math.floor(Math.random()*i.length)}return{seatId:a,valid:!g}},r=()=>{let s={},o=[...c];y.sort((i,f)=>{var v=i.rules.filter(a=>a.type==="location").length,R=f.rules.filter(a=>a.type==="location").length,_=i.rules.filter(a=>a.type==="facing").length,g=f.rules.filter(a=>a.type==="facing").length;return v>R||_>g?-1:f.rules.length-i.rules.length}).forEach(i=>{const{seatId:f,valid:v}=d(i,s,o);f!==null&&(i.valid=v,s[f]=i,o=o.filter(R=>R.id!==f))}),c.forEach(i=>{i.id in s||(s[i.id]={firstName:"Empty",lastName:"Seat",valid:!0})}),t(1,u=s)};return ie(async()=>{t(0,c=await oe()),y=await ne();let s={};p={},c.forEach(o=>{s[o.id]={firstName:"Empty",lastName:"Seat",valid:!0},p[o.id]=I(o)}),t(1,u=s)}),[c,u,r]}class ue extends Y{constructor(l){super(),Z(this,l,fe,ce,ee,{})}}export{ue as default};
