import{S as se,i as ae,s as ie,N as re,O as ne,e as T,t as P,k as $,c as k,a as D,h as W,m as G,d as u,b as F,f as A,g as M,H as R,j as oe,x as fe,P as ce,y as ue,z as de,I as he,Q as pe,R as _e,r as me,p as ve,C as ge,w as ye,T as Ee}from"../chunks/index-73f85fd5.js";import{g as Re,a as Se,b as be}from"../chunks/db-61e6d286.js";import{S as He}from"../chunks/SelectField-d67783ee.js";function te(y,a,l){const d=y.slice();return d[13]=a[l],d}function le(y,a){var O,C;let l,d=((O=a[1][a[13].id])==null?void 0:O.firstName)+" "+((C=a[1][a[13].id])==null?void 0:C.lastName),S,m,v=`${a[13].left}px`,h=`${a[13].top}px`;return{key:y,first:null,c(){l=T("div"),S=P(d),m=$(),this.h()},l(f){l=k(f,"DIV",{class:!0});var p=D(l);S=W(p,d),m=G(p),p.forEach(u),this.h()},h(){F(l,"class","seat-box svelte-a2eqnd"),A(l,"left",v,!1),A(l,"top",h,!1),A(l,"background-color",a[4](a[1][a[13].id]),!1),this.first=l},m(f,p){M(f,l,p),R(l,S),R(l,m)},p(f,p){var I,E;a=f,p&3&&d!==(d=((I=a[1][a[13].id])==null?void 0:I.firstName)+" "+((E=a[1][a[13].id])==null?void 0:E.lastName))&&oe(S,d),p&1&&v!==(v=`${a[13].left}px`)&&A(l,"left",v,!1),p&1&&h!==(h=`${a[13].top}px`)&&A(l,"top",h,!1),p&3&&A(l,"background-color",a[4](a[1][a[13].id]),!1)},d(f){f&&u(l)}}}function Le(y){let a,l,d,S,m,v,h,O,C,f,p,I,E,N,K,r,i,t,_,L,g,n=[],w=new Map,b,H,s;function z(e){y[7](e)}let q={fullwidth:"true",options:y[3],onChange:y[6]};y[2]!==void 0&&(q.value=y[2]),f=new He({props:q}),re.push(()=>ne(f,"value",z));let V=y[0];const Q=e=>e[13].id;for(let e=0;e<V.length;e+=1){let o=te(y,V,e),c=Q(o);w.set(c,n[e]=le(c,o))}return{c(){a=$(),l=T("h2"),d=P("Generate Seating Chart"),S=$(),m=T("div"),v=T("div"),h=T("button"),O=P("Generate Chart"),C=$(),fe(f.$$.fragment),I=$(),E=T("div"),N=T("h4"),K=P("Front"),r=$(),i=T("div"),t=T("h4"),_=P("Left"),L=$(),g=T("div");for(let e=0;e<n.length;e+=1)n[e].c();this.h()},l(e){ce('[data-svelte="svelte-3kq8j0"]',document.head).forEach(u),a=G(e),l=k(e,"H2",{class:!0});var c=D(l);d=W(c,"Generate Seating Chart"),c.forEach(u),S=G(e),m=k(e,"DIV",{class:!0});var B=D(m);v=k(B,"DIV",{class:!0});var U=D(v);h=k(U,"BUTTON",{class:!0});var j=D(h);O=W(j,"Generate Chart"),j.forEach(u),U.forEach(u),B.forEach(u),C=G(e),ue(f.$$.fragment,e),I=G(e),E=k(e,"DIV",{class:!0});var J=D(E);N=k(J,"H4",{class:!0});var Z=D(N);K=W(Z,"Front"),Z.forEach(u),r=G(J),i=k(J,"DIV",{class:!0});var X=D(i);t=k(X,"H4",{class:!0});var x=D(t);_=W(x,"Left"),x.forEach(u),L=G(X),g=k(X,"DIV",{class:!0});var ee=D(g);for(let Y=0;Y<n.length;Y+=1)n[Y].l(ee);ee.forEach(u),X.forEach(u),J.forEach(u),this.h()},h(){document.title="Generate Seating Chart",F(l,"class","title is-2"),F(h,"class","button is-primary"),F(v,"class","control"),F(m,"class","field is-grouped"),F(N,"class","title is-4 has-text-centered mb-0 front-heading svelte-a2eqnd"),F(t,"class","title is-4 has-text-centered left-heading svelte-a2eqnd"),F(g,"class","room-container svelte-a2eqnd"),F(i,"class","is-flex"),F(E,"class","box")},m(e,o){M(e,a,o),M(e,l,o),R(l,d),M(e,S,o),M(e,m,o),R(m,v),R(v,h),R(h,O),M(e,C,o),de(f,e,o),M(e,I,o),M(e,E,o),R(E,N),R(N,K),R(E,r),R(E,i),R(i,t),R(t,_),R(i,L),R(i,g);for(let c=0;c<n.length;c+=1)n[c].m(g,null);b=!0,H||(s=he(h,"click",y[5]),H=!0)},p(e,[o]){const c={};o&8&&(c.options=e[3]),!p&&o&4&&(p=!0,c.value=e[2],pe(()=>p=!1)),f.$set(c),o&19&&(V=e[0],n=_e(n,o,Q,1,e,V,w,g,Ee,le,null,te))},i(e){b||(me(f.$$.fragment,e),b=!0)},o(e){ve(f.$$.fragment,e),b=!1},d(e){e&&u(a),e&&u(l),e&&u(S),e&&u(m),e&&u(C),ge(f,e),e&&u(I),e&&u(E);for(let o=0;o<n.length;o+=1)n[o].d();H=!1,s()}}}function Te(y,a,l){let d=[],S=[],m={},v={},h=1,O=[];const C={front:0,right:1,back:2,left:3},f=r=>{let i="white";return r&&(r.valid?r.empty?i="white":i="lightgreen":i="#FF4F40"),i},p=({top:r,left:i})=>{let n=[];return r<200&&n.push("front"),r>600&&n.push("back"),i<700&&n.push("left"),i>700&&n.push("right"),n},I=(r,i,t)=>{const _=r.rules.filter(s=>s.type==="seat").map(s=>s.criteria);if(_&&_.length>0)return{seatId:_[0],valid:!0};const L=r.rules.filter(s=>s.type==="facing").map(s=>C[s.criteria]),g=r.rules.filter(s=>s.type==="location").map(s=>s.criteria);let n=Math.floor(Math.random()*t.length),w=!0,b=null,H=[...t];for(;w&&H.length>0;){const s=H[n];let z=[];s.group.forEach(c=>{const B=i[c],U=(B==null?void 0:B.rules.filter(j=>j.type==="nogroup"))||[];z.push(U.map(j=>j.criteria))}),b=H[n].id;const q=i[b],V=typeof q!="undefined"&&q!==null&&q!=="",Q=z.flat().filter(c=>r.id===c).length>0,e=L.length>0?L[0]!=s.direction:!1,o=g.length>0?!v[b].includes(g[0]):!1;w=V||Q||e||o,H=H.filter(c=>c.id!==b),n=Math.floor(Math.random()*H.length)}return{seatId:b,valid:!w}},E=()=>{let r={},i=[...d];S.sort((t,_)=>{var L=t.rules.filter(s=>s.type==="location").length,g=_.rules.filter(s=>s.type==="location").length,n=t.rules.filter(s=>s.type==="facing").length,w=_.rules.filter(s=>s.type==="facing").length,b=t.rules.filter(s=>s.type==="seat").length,H=t.rules.filter(s=>s.type==="seat").length;return b>H||L>g||n>w?-1:_.rules.length-t.rules.length}).forEach(t=>{console.log(t);const{seatId:_,valid:L}=I(t,r,i);_!==null&&(t.valid=L,t.empty=!1,r[_]=t,i=i.filter(g=>g.id!==_))}),d.forEach(t=>{t.id in r||(r[t.id]={firstName:"Empty",lastName:"Seat",valid:!0,empty:!0})}),l(1,m=r)},N=async()=>{S=await be(h)};ye(async()=>{l(0,d=await Re());const r=await Se();l(3,O=r.map(t=>({value:t.id,text:t.name}))),await N();let i={};v={},d.forEach(t=>{i[t.id]={firstName:"Empty",lastName:"Seat",valid:!0,empty:!0},v[t.id]=p(t)}),l(1,m=i)});function K(r){h=r,l(2,h)}return[d,m,h,O,f,E,N,K]}class Oe extends se{constructor(a){super(),ae(this,a,Te,Le,ie,{})}}export{Oe as default};
